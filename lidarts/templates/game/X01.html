{% extends "base.html" %}
{% block title %}X01{% endblock %}
{% block css %}<link href="{{ url_for('static',filename='css/x01.css') }}" rel="stylesheet">{% endblock %}

{% block navbar %}
<div class="container-fluid">
    <div class="row mb-2">
        <div id="hide-keypad">Toggle Keypad</div><a href="{{ url_for('generic.index') }}">Index</a>
    </div>
</div>
{% endblock %}

{% block app_content %}

<div class="row justify-content-center align-items-center">
    <div class="col-lg-5 col-sm-6">
        <div class="card text-center player_turn" id="p1_turn_outer_card">
            <div class="card-body">
                <div class="card text-center text-light mb-1" id="p1_turn_name_card">
                    <div class="card-body">
                        <h3>{{ game.player1_name }}</h3>
                    </div>
                </div>

                <div class="card text-center text-light" id="p1_turn_score_card">
                    <div class="card-body">
                        <h1 id="p1_score" class="card-text" style="font-weight: bold"></h1>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-2 text-center bg-dark text-light d-none d-lg-block" style="padding-left: 0px; padding-right: 0px;">
        <div class="row mb-3">
            {% if game.bo_sets == 1 %}
            <div class="col">Best of {{ game.bo_legs }} Legs</div>
            {% else %}
            <div class="col">Best of {{ game.bo_legs }} Sets</div>
            {% endif %}
        </div>
        <div class="card bg-info">
            <div class="card-body" style="padding-top: 10px; padding-bottom: 10px;">
                <div class="row align-items-center mb-3">
                    <div class="col-sm-3"><h4 class="card-text"><span id="p1_sets" style="font-weight:bold"></span></h4></div>
                    <div class="col-sm-6">Sets</div>
                    <div class="col-sm-3"><h4 class="card-text"><span id="p2_sets" style="font-weight:bold"></span></h4></div>
                </div>
                <div class="row align-items-center">
                    <div class="col-sm-3"><h4 class="card-text"><span id="p1_legs" style="font-weight:bold"></span></h4></div>
                    <div class="col-sm-6">Legs</div>
                    <div class="col-sm-3"><h4 class="card-text"><span id="p2_legs" style="font-weight:bold"></span></h4></div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-5 col-sm-6">
        <div class="card text-center player_turn" id="p2_turn_outer_card">
            <div class="card-body">
                <div class="card text-center text-light mb-1" id="p2_turn_name_card">
                    <div class="card-body">
                        <h3>{{ game.player2_name }}</h3>
                    </div>
                </div>
                <div class="card text-center text-light" id="p2_turn_score_card">
                    <div class="card-body">
                        <h1 id="p2_score" class="card-text" style="font-weight: bold"></h1>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row justify-content-center align-items-start text-center mt-sm-2">
    <div class="col-md-4 offset-md-1 col-sm-6 d-lg-none">
        <div class="card bg-info text-light">
            <div class="card-body" style="padding-top: 0px; padding-bottom: 0px">
                <div class="row">
                    <div class="col-sm-6">Sets: <strong>{{ game.p1_sets }}</strong></div>
                    <div class="col-sm-6">Legs: <strong>{{ game.p1_legs }}</strong></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4 offset-md-2 col-sm-6 d-lg-none">
        <div class="card bg-info text-light">
            <div class="card-body" style="padding-top: 0px; padding-bottom: 0px">
                <div class="row">
                    <div class="col-sm-6">Sets: <strong>{{ game.p2_sets }}</strong></div>
                    <div class="col-sm-6">Legs: <strong>{{ game.p2_legs }}</strong></div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-1"></div>

</div>

<div class="row justify-content-center align-items-start">
    <div class="col-lg-4 col-md-4 col-sm-6 mt-3" id="p1_current_leg">
    </div>

    <div class="col-lg-3 col-md-4 mt-3 d-none d-md-block">

        <form class="text-center" id="score_input" method="POST" action="" autocomplete="off" {% if game.status == 'completed' or not (current_user.id == game.player1 or current_user.id == game.player2) %} style="display: none" {% endif %}>
        {{ form.hidden_tag() }}
        <div class="col-xl-6 offset-xl-3 col-lg-8 offset-lg-2 col-md-10 offset-md-1 d-flex align-items-center mb-2">
            {{ form.score_value(class="bg-light text-center form-control form-control-lg border-secondary",
            style="font-size: 35px; padding-top: 1px; padding-bottom: 1px; padding-left: 1px; padding-right: 1px;") }}
        </div>
        <div id="input-keypad">
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-1" class="btn btn-xl btn-secondary w-100 rounded-0 btn-rnd-tl">1</button>
                <button type="button" id="button-2" class="btn btn-xl btn-secondary w-100">2</button>
                <button type="button" id="button-3" class="btn btn-xl btn-secondary w-100 rounded-0 btn-rnd-tr">3</button>
            </div>
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-4" class="btn btn-xl btn-secondary w-100 rounded-0">4</button>
                <button type="button" id="button-5" class="btn btn-xl btn-secondary w-100">5</button>
                <button type="button" id="button-6" class="btn btn-xl btn-secondary w-100 rounded-0">6</button>
            </div>
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-7" class="btn btn-xl btn-secondary w-100 rounded-0">7</button>
                <button type="button" id="button-8" class="btn btn-xl btn-secondary w-100">8</button>
                <button type="button" id="button-9" class="btn btn-xl btn-secondary w-100 rounded-0">9</button>
            </div>
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-del" class="btn btn-xl btn-danger w-100 rounded-0 btn-rnd-bl" style="font-size: 25px;"><i class="fas fa-times-circle" ></i></button>
                <button type="button" id="button-0" class="btn btn-xl btn-secondary w-100">0</button>
                <button type="button" id="button-conf" class="btn btn-xl btn-success w-100 rounded-0 btn-rnd-br" style="font-size: 25px;"><i class="fas fa-check-circle" ></i></button>
            </div>
        </div>

        </form>
        <form class="text-center" id="confirm_completion" method="POST" action="" {% if not game.status == 'completed' %} style="display: none" {% endif %}>
        <h4 class="text-light">Game is completed.</h4>
        <a href="{{ url_for('game.start', hashid=game.hashid) }}">Game overview</a>
        </form>


    </div>

    <div class="col-lg-4 col-md-4 col-sm-6 mt-3 d-none d-sm-block">
        <p id="p2_current_leg"></p>
    </div>
</div>

<div class="row fixed-bottom">

    <div class="col-sm-12 d-md-none">

        <div class="col-xl-6 offset-xl-3 col-lg-8 offset-lg-2 col-md-10 offset-md-1 d-flex align-items-center mb-2">
            <input class="bg-light text-center form-control form-control-lg border-secondary" id="score_value_sm"
                   style="font-size: 35px; padding-top: 1px; padding-bottom: 1px; padding-left: 1px; padding-right: 1px;">
        </div>
        <div id="input-keypad1">
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-sm-1" class="btn btn-xl btn-secondary w-100 rounded-0">1</button>
                <button type="button" id="button-sm-2" class="btn btn-xl btn-secondary w-100">2</button>
                <button type="button" id="button-sm-3" class="btn btn-xl btn-secondary w-100 rounded-0">3</button>
            </div>
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-sm-4" class="btn btn-xl btn-secondary w-100 rounded-0">4</button>
                <button type="button" id="button-sm-5" class="btn btn-xl btn-secondary w-100">5</button>
                <button type="button" id="button-sm-6" class="btn btn-xl btn-secondary w-100 rounded-0">6</button>
            </div>
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-sm-7" class="btn btn-xl btn-secondary w-100 rounded-0">7</button>
                <button type="button" id="button-sm-8" class="btn btn-xl btn-secondary w-100">8</button>
                <button type="button" id="button-sm-9" class="btn btn-xl btn-secondary w-100 rounded-0">9</button>
            </div>
            <div class="btn-group d-flex" role="group" aria-label="Basic example">
                <button type="button" id="button-sm-del" class="btn btn-xl btn-danger w-100 rounded-0" style="font-size: 25px;"><i class="fas fa-times-circle" ></i></button>
                <button type="button" id="button-sm-0" class="btn btn-xl btn-secondary w-100">0</button>
                <button type="button" id="button-sm-conf" class="btn btn-xl btn-success w-100 rounded-0" style="font-size: 25px;"><i class="fas fa-check-circle" ></i></button>
            </div>
        </div>

    </div>
</div>

<div class="modal fade game-shot-modal" id="game-shot-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content">
            <h2 class="text-center">Game Shot</h2>
        </div>
    </div>
</div>

<div class="modal fade match-shot-modal" id="match-shot-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content">
            <h2 class="text-center">Game Shot and the match</h2>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<meta id="hash_id" data-hashid="{{ game.hashid }}">
<meta id="validation_url" data-url="{{ url_for('game.validate_score') }}">
<meta id="user_id" data-id="{{ current_user.id }}">

{% if current_user.id == game.player1 or current_user.id == game.player2 %}
<script type="text/javascript" src="/static/js/x01_socket.js"></script>
{% else %}
<script type="text/javascript" src="/static/js/x01_spectator_socket.js"></script>
{% endif %}
{% endblock %}
